datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URI")
}

generator client {
  provider = "prisma-client-js"
  // binaryTargets = ["linux-musl-openssl-3.0.x"]
}

model Avocado {
  id        String    @id @default(uuid())
  createdAt DateTime  @default(now())
  updatedAt DateTime? @updatedAt
  deletedAt DateTime?

  name       String
  sku        String      @unique
  price      Float
  image      String
  attributes Attributes?
}

model Attributes {
  id          String  @id @default(uuid())
  description String?
  shape       String?
  hardiness   String?
  taste       String?
  avocado     Avocado @relation(fields: [avocadoId], references: [id])
  avocadoId   String  @unique
}

//Real models

enum ROLE {
  ADMIN
  BARBER
  CUSTOMER
}

enum STATE {
  ACTIVE
  INACTIVE
}

enum APPOINTMENTE_STATE {
  CANCELED
  SCHEDULED
  DONE
}

enum SERVICE {
  HAIRCUT
  BEARD
}

model Service {
  id          Int           @id @default(autoincrement())
  name        SERVICE       @default(HAIRCUT)
  price       Int
  createdAt DateTime  @default(now())
  updatedAt DateTime? @updatedAt
  Appointment Appointment[]
}

model User {
  id                  Int           @id @default(autoincrement())
  name                String
  documentNumber      String        @unique
  phone               String        @unique
  birthDate           DateTime
  urlImg              String?
  email               String        @unique
  state               STATE         @default(ACTIVE)
  role                ROLE          @default(CUSTOMER)
  createdAt DateTime  @default(now())
  updatedAt DateTime? @updatedAt
  EngagementBarber    Engagement[]  @relation("barber")
  EngagementAdmin     Engagement[]  @relation("administrator")
  AppointmentBarber   Appointment[] @relation("barber")
  AppointmentCustomer Appointment[] @relation("customer")
}

model Engagement {
  administratorId Int
  administrator   User @relation("administrator", fields: [administratorId], references: [id])
  barberId        Int
  barber          User @relation("barber", fields: [barberId], references: [id])
  salary          Int
  createdAt DateTime  @default(now())
  updatedAt DateTime? @updatedAt
  @@id([administratorId, barberId])
}

model Appointment {
  customerId      Int
  customer        User               @relation("customer", fields: [customerId], references: [id])
  barberId        Int
  barber          User               @relation("barber", fields: [barberId], references: [id])
  serviceId       Int
  service         Service            @relation(fields: [serviceId], references: [id])
  appointmentDate DateTime
  state           APPOINTMENTE_STATE @default(SCHEDULED)
  createdAt DateTime  @default(now())
  updatedAt DateTime? @updatedAt
  @@id([customerId, barberId])
}
